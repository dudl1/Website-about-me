<!DOCTYPE html>
<!--<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="Валерий">
    <meta name="keywords" content="программирование, технологии, веб-разработка, вёрстка сайтов">
    <title>iValery</title>
    <link rel="icon" href="favicon.png" type="image/png">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="page_loading">
        <span>Загрузка :0</span>
    </div>

    <header>

        <div class="valery_photo">
            <img src="images/avatar.jpeg" alt="">
        </div>

        <button class="valery_burger">
            <svg class="burger_svg" xmlns="http://www.w3.org/2000/svg" id="Outline_1" viewBox="0 0 24 24" width="512" height="512"><rect y="11" width="24" height="2" rx="1"/><rect y="4" width="24" height="2" rx="1"/><rect y="18" width="24" height="2" rx="1"/></svg>

            <svg class="close_svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 511.991 511.991" style="enable-background:new 0 0 511.991 511.991;" xml:space="preserve" width="512" height="512">
                <g>
                    <path d="M286.161,255.867L505.745,36.283c8.185-8.474,7.951-21.98-0.523-30.165c-8.267-7.985-21.375-7.985-29.642,0   L255.995,225.702L36.411,6.118c-8.475-8.185-21.98-7.95-30.165,0.524c-7.985,8.267-7.985,21.374,0,29.641L225.83,255.867   L6.246,475.451c-8.328,8.331-8.328,21.835,0,30.165l0,0c8.331,8.328,21.835,8.328,30.165,0l219.584-219.584l219.584,219.584   c8.331,8.328,21.835,8.328,30.165,0l0,0c8.328-8.331,8.328-21.835,0-30.165L286.161,255.867z"/>
                </g>
            </svg>
        </button>

    </header>

    <div class="text_animated">
        <div id="valery_name">
            <span class="letter-img">
                <span class="letter">В</span>
                <img class="image" src="icons/html.png" alt="image1">
            </span>
            <span class="letter-img">
                <span class="letter">а</span>
                <img class="image" src="icons/css.png" alt="image2">
            </span>
            <span class="letter-img">
                <span class="letter">л</span>
                <img class="image" src="icons/js.png" alt="image3">
            </span>
            <span class="letter-img">
                <span class="letter">е</span>
                <img class="image" src="icons/dart.png" alt="image4">
            </span>
            <span class="letter-img">
                <span class="letter">р</span>
                <img class="image" src="icons/python.png" alt="image5">
            </span>
            <span class="letter-img">
                <span class="letter">и</span>
                <img class="image" src="icons/supabase.png" alt="image6">
            </span>
            <span class="letter-img">
                <span class="letter">й</span>
                <img class="image" src="icons/github_light.png" alt="image7">
            </span>
        </div>
    </div>    
    
    <div class="menu">
        <div class="header_burger">
            <button class="burder_close">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 511.991 511.991" style="enable-background:new 0 0 511.991 511.991;" xml:space="preserve" width="512" height="512">
                    <g>
                        <path d="M286.161,255.867L505.745,36.283c8.185-8.474,7.951-21.98-0.523-30.165c-8.267-7.985-21.375-7.985-29.642,0   L255.995,225.702L36.411,6.118c-8.475-8.185-21.98-7.95-30.165,0.524c-7.985,8.267-7.985,21.374,0,29.641L225.83,255.867   L6.246,475.451c-8.328,8.331-8.328,21.835,0,30.165l0,0c8.331,8.328,21.835,8.328,30.165,0l219.584-219.584l219.584,219.584   c8.331,8.328,21.835,8.328,30.165,0l0,0c8.328-8.331,8.328-21.835,0-30.165L286.161,255.867z"/>
                    </g>
                </svg>
            </button>
        </div>
        <span class="menu_item my_portfolio" style="cursor: default; color: rgb(175, 175, 175);">Портфолио</span>
        <span class="menu_item my_stack ">Стек технологий</span>
        <a class="menu_item" href="https://github.com/dudl1">Github</a>
        <a class="menu_item" href="https://t.me/dudl1">Telegram</a>
    </div>

    <div class="bloks">

        <div class="blok_stack my_portfolio"></div>

        <div class="blok_stack my_stack" style="display: none;"></div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>\
    <script src="animation.js"></script>
    <script src="script.js"></script>
</body>
</html>-->







<!DOCTYPE html>
<html>
<head>
    <title>WebRTC Messaging</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
</head>
<body>
    <input type="text" id="messageInput" placeholder="Message">
    <button onclick="sendMessage()">Send</button>
    <ul id="messages"></ul>

    <script>
    const socket = io('https://1234abcd.ngrok.io', {
      withCredentials: true,
    });

    let peer = new RTCPeerConnection({
        iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] // Использование публичного STUN сервера
    });

    let dataChannel = peer.createDataChannel("chat");

    dataChannel.onopen = function (event) {
      console.log("DataChannel is open");
    };

    dataChannel.onmessage = function (event) {
      console.log("Received message:", event.data);
      document.getElementById('messages').innerHTML += `<li>${event.data}</li>`;
    };

    // Обработка кандидатов ICE
    peer.onicecandidate = function(event) {
        if (event.candidate) {
            socket.emit('ice', event.candidate);
        }
    };

    // При получении кандидата от другого пира
    socket.on('ice', function(candidate) {
        peer.addIceCandidate(new RTCIceCandidate(candidate));
    });

    // Обработка SDP описаний
    peer.onnegotiationneeded = async () => {
        const offer = await peer.createOffer();
        await peer.setLocalDescription(offer);
        socket.emit('sdp', peer.localDescription);
    };

    socket.on('sdp', async (description) => {
        if (description.type === 'offer' && peer.signalingState !== 'stable') {
            await peer.setRemoteDescription(description);
            const answer = await peer.createAnswer();
            await peer.setLocalDescription(answer);
            socket.emit('sdp', peer.localDescription);
        } else if (description.type === 'answer') {
            await peer.setRemoteDescription(description);
        }
    });

    function sendMessage() {
        const message = document.getElementById('messageInput').value;
        dataChannel.send(message);
        document.getElementById('messages').innerHTML += `<li>You: ${message}</li>`;
    }
    </script>
</body>
</html>
